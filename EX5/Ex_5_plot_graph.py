import matplotlib.pyplot as plt
import numpy as np

data3 = [{'h': 1, 'J': 0.15000000000000002, 'K': 204800, '<M>': 233.04275152684025, '<M^2>': 54354.29379620701,
          'std': 108.68656595291395, '<U>': -296.694824815172, '<U^2>': 88136.50563805853, 'cv': 0.04072376927303032,
          'flip_ratio': 0.08547258947649573},
         {'h': 1, 'J': 0.2, 'K': 12800, '<M>': 241.03521126760563, '<M^2>': 58130.126760563384,
          'std': 99.19830787547107, '<U>': -331.8014084507041, '<U^2>': 110191.37295774645, 'cv': 0.03890560441927031,
          'flip_ratio': 0.0589204210836278},
         {'h': 1, 'J': 0.25, 'K': 200, '<M>': 246.33333333333334, '<M^2>': 60700.666666666664, 'std': 82.22222222221899,
          '<U>': -364.6666666666667, '<U^2>': 133064.0, 'cv': 0.035420496116497856, 'flip_ratio': 0.038318452380952384},
         {'h': 1, 'J': 0.3, 'K': 100, '<M>': 248.6, '<M^2>': 61807.6, 'std': 26.05439999990631,
          '<U>': -393.44000000000017, '<U^2>': 154821.08800000005, 'cv': 0.01993887142615074,
          'flip_ratio': 0.027473958333333333},
         {'h': 1, 'J': 0.35, 'K': 100, '<M>': 250.71428571428572, '<M^2>': 62864.28571428572, 'std': 37.03122448979411,
          '<U>': -422.6142857142856, '<U^2>': 178639.8657142856, 'cv': 0.02377081494639703,
          'flip_ratio': 0.01878720238095238},
         {'h': 1, 'J': 0.39999999999999997, 'K': 3200, '<M>': 253.13960113960113, '<M^2>': 64084.900284900286,
          'std': 34.66472901997622, '<U>': -453.3994301994304, '<U^2>': 205605.70803418814, 'cv': 0.0229987344874569,
          'flip_ratio': 0.011999775179856115},
         {'h': 1, 'J': 0.44999999999999996, 'K': 200, '<M>': 254.22857142857143, '<M^2>': 64636.45714285714,
          'std': 33.63840000005439, '<U>': -481.4399999999998, '<U^2>': 231818.11199999988, 'cv': 0.02265571120050814,
          'flip_ratio': 0.007477678571428572},
         {'h': 1, 'J': 0.49999999999999994, 'K': 100, '<M>': 254.66666666666666, '<M^2>': 64858.37037037037,
          'std': 29.333333333343035, '<U>': -508.0, '<U^2>': 258093.33333333334, 'cv': 0.021156350012076313,
          'flip_ratio': 0.004918981481481482},
         {'h': 1, 'J': 0.5499999999999999, 'K': 200, '<M>': 255.13846153846154, '<M^2>': 65097.96923076923,
          'std': 23.90706745564239, '<U>': -534.8430769230771, '<U^2>': 286081.0240000002, 'cv': 0.01909955233529325,
          'flip_ratio': 0.003689236111111111},
         {'h': 1, 'J': 0.6, 'K': 100, '<M>': 255.40350877192984, '<M^2>': 65231.929824561405, 'std': 11.300264696998056,
          '<U>': -561.1719298245612, '<U^2>': 314925.2350877192, 'cv': 0.01313119778854575,
          'flip_ratio': 0.00229577850877193},
         {'h': 1, 'J': 0.65, 'K': 200, '<M>': 255.67195767195767, '<M^2>': 65368.78306878307, 'std': 8.205351473763585,
          '<U>': -587.6190476190477, '<U^2>': 345304.35047619045, 'cv': 0.011189447141026765,
          'flip_ratio': 0.001525405765503876},
         {'h': 1, 'J': 0.7000000000000001, 'K': 100, '<M>': 255.75510204081633, '<M^2>': 65411.12925170068,
          'std': 6.5995390811003745, '<U>': -613.4693877551018, '<U^2>': 376351.28925170057, 'cv': 0.010034987531045352,
          'flip_ratio': 0.0008901998299319728},
         {'h': 1, 'J': 0.7500000000000001, 'K': 100, '<M>': 255.8547215496368, '<M^2>': 65461.90799031477,
          'std': 4.311217161477543, '<U>': -639.4188861985472, '<U^2>': 408860.82324455207, 'cv': 0.008110730748188836,
          'flip_ratio': 0.0006337015738498789},
         {'h': 1, 'J': 0.8000000000000002, 'K': 100, '<M>': 255.9014308426073, '<M^2>': 65485.74244833068,
          'std': 3.530487891694065, '<U>': -665.186009538951, '<U^2>': 442475.9577742451, 'cv': 0.007339684599972269,
          'flip_ratio': 0.00041815712771595126}]

data2 = [{'h': 0.5, 'J': 0.15000000000000002, 'K': 819200, '<M>': 182.55294659300185, '<M^2>': 33463.11694290976,
          'std': 122.387428005517, '<U>': -130.3069981583794, '<U^2>': 17102.30119705341, 'cv': 0.04321439514604004,
          'flip_ratio': 0.24546705404057836},
         {'h': 0.5, 'J': 0.2, 'K': 409600, '<M>': 203.378856152513, '<M^2>': 41467.18890814558,
          'std': 137.45320389152403, '<U>': -166.34357019064126, '<U^2>': 27807.63654766032, 'cv': 0.045797046238219,
          'flip_ratio': 0.1842978828322967},
         {'h': 0.5, 'J': 0.25, 'K': 204800, '<M>': 219.8740157480315, '<M^2>': 48422.28346456693,
          'std': 144.77225416951114, '<U>': -204.4271653543307, '<U^2>': 41935.23818897638, 'cv': 0.04700052434255608,
          'flip_ratio': 0.13105868652743652},
         {'h': 0.5, 'J': 0.3, 'K': 25600, '<M>': 232.33962264150944, '<M^2>': 54027.50404312668,
          'std': 118.4825649334307, '<U>': -242.6258760107816, '<U^2>': 58985.798274932604, 'cv': 0.04251941281230467,
          'flip_ratio': 0.08896006944444444},
         {'h': 0.5, 'J': 0.35, 'K': 6400, '<M>': 240.38571428571427, '<M^2>': 57819.05714285714,
          'std': 110.87006326530536, '<U>': -278.13285714285706, '<U^2>': 77468.75628571425, 'cv': 0.04113080243213502,
          'flip_ratio': 0.05935560726950355},
         {'h': 0.5, 'J': 0.39999999999999997, 'K': 6400, '<M>': 246.0814479638009, '<M^2>': 60575.60180995475,
          'std': 81.85459429575712, '<U>': -312.2389140271494, '<U^2>': 97574.99402714935, 'cv': 0.0353412222221512,
          'flip_ratio': 0.03782817213423831},
         {'h': 0.5, 'J': 0.44999999999999996, 'K': 100, '<M>': 250.16666666666666, '<M^2>': 62596.333333333336,
          'std': 68.62305555552302, '<U>': -344.9833333333333, '<U^2>': 119082.12333333328, 'cv': 0.03235899765978459,
          'flip_ratio': 0.022352430555555556},
         {'h': 0.5, 'J': 0.49999999999999994, 'K': 3200, '<M>': 251.83908045977012, '<M^2>': 63432.0153256705,
          'std': 55.28735632184544, '<U>': -373.6666666666667, '<U^2>': 139682.06513409963, 'cv': 0.029045104715568086,
          'flip_ratio': 0.016167534722222224},
         {'h': 0.5, 'J': 0.5499999999999999, 'K': 800, '<M>': 253.3939393939394, '<M^2>': 64214.343434343435,
          'std': 42.20357106416486, '<U>': -402.6080808080809, '<U^2>': 162135.47030303036, 'cv': 0.0253766701628153,
          'flip_ratio': 0.01041018864013267},
         {'h': 0.5, 'J': 0.6, 'K': 200, '<M>': 254.32432432432432, '<M^2>': 64684.0, 'std': 26.391059167217463,
          '<U>': -430.3405405405404, '<U^2>': 185219.37189189173, 'cv': 0.020067276969447753,
          'flip_ratio': 0.007170376712328767},
         {'h': 0.5, 'J': 0.65, 'K': 200, '<M>': 254.91228070175438, '<M^2>': 64982.38596491228,
          'std': 20.326229609112488, '<U>': -457.42807017543873, '<U^2>': 209260.76561403522,
          'cv': 0.017611179689089238, 'flip_ratio': 0.004802178899082569},
         {'h': 0.5, 'J': 0.7000000000000001, 'K': 200, '<M>': 255.19402985074626, '<M^2>': 65125.19402985075,
          'std': 13.080614836217137, '<U>': -483.74029850746257, '<U^2>': 234017.7570149252, 'cv': 0.014127786188700807,
          'flip_ratio': 0.0034436677631578946},
         {'h': 0.5, 'J': 0.7500000000000001, 'K': 400, '<M>': 255.37444933920705, '<M^2>': 65217.32158590308,
          'std': 14.849579848232679, '<U>': -509.8105726872247, '<U^2>': 259921.66960352423, 'cv': 0.01505279397889087,
          'flip_ratio': 0.002123478701825558},
         {'h': 0.5, 'J': 0.8000000000000002, 'K': 400, '<M>': 255.70792079207922, '<M^2>': 65387.13861386139,
          'std': 8.184676747361664, '<U>': -536.5193069306933, '<U^2>': 287861.15138613887, 'cv': 0.011175341428016426,
          'flip_ratio': 0.0013168797348484848}]

data1 = [{'h': 0.1, 'J': 0.15000000000000002, 'K': 1600, '<M>': 62.0, '<M^2>': 4226.0, 'std': 15.580000000000013,
          '<U>': -13.4, '<U^2>': 195.14000000000001, 'cv': 0.015418558090617623, 'flip_ratio': 0.46556712962962965},
         {'h': 0.1, 'J': 0.2, 'K': 13107200, '<M>': 69.59290114243846, '<M^2>': 5222.7710509891185,
          'std': 64.25766662915723, '<U>': -14.525326314075603, '<U^2>': 275.24277115953436, 'cv': 0.031312843702588807,
          'flip_ratio': 0.4628818403827812},
         {'h': 0.1, 'J': 0.25, 'K': 13107200, '<M>': 97.41391574412664, '<M^2>': 9932.66763512498,
          'std': 144.72337252198872, '<U>': -28.338496218003307, '<U^2>': 947.7937404197764, 'cv': 0.04699258892343169,
          'flip_ratio': 0.4273995649842021},
         {'h': 0.1, 'J': 0.3, 'K': 13107200, '<M>': 137.17334334835587, '<M^2>': 19259.329494241363,
          'std': 292.18274963744716, '<U>': -57.89788015356368, '<U^2>': 3644.347275913871, 'cv': 0.06677091391031767,
          'flip_ratio': 0.35601774470844283},
         {'h': 0.1, 'J': 0.35, 'K': 800, '<M>': 150.0, '<M^2>': 22650.0, 'std': 106.64000000000033,
          '<U>': -75.19999999999999, '<U^2>': 5761.6799999999985, 'cv': 0.040338533260705016,
          'flip_ratio': 0.34188988095238093},
         {'h': 0.1, 'J': 0.39999999999999997, 'K': 1638400, '<M>': 213.99576629974598, '<M^2>': 45948.623765170756,
          'std': 330.4191855609788, '<U>': -164.5051933389783, '<U^2>': 27392.37782105561, 'cv': 0.07100561002257513,
          'flip_ratio': 0.15045456064800122},
         {'h': 0.1, 'J': 0.44999999999999996, 'K': 12800, '<M>': 233.1919191919192, '<M^2>': 54434.50505050505,
          'std': 172.01919089889998, '<U>': -214.40101010101006, '<U^2>': 46139.81232323232, 'cv': 0.05123284638421171,
          'flip_ratio': 0.08786663925438597},
         {'h': 0.1, 'J': 0.49999999999999994, 'K': 6400, '<M>': 241.7579617834395, '<M^2>': 58486.62420382166,
          'std': 158.49200535519049, '<U>': -252.49426751592353, '<U^2>': 63911.84713375795, 'cv': 0.049177190625405515,
          'flip_ratio': 0.05440333197611292},
         {'h': 0.1, 'J': 0.5499999999999999, 'K': 1600, '<M>': 247.84848484848484, '<M^2>': 61445.757575757576,
          'std': 85.42906336086162, '<U>': -288.7181818181818, '<U^2>': 83443.61757575754, 'cv': 0.036104626540518804,
          'flip_ratio': 0.03552039194915254},
         {'h': 0.1, 'J': 0.6, 'K': 3200, '<M>': 251.12, '<M^2>': 63071.05777777778, 'std': 59.42660266664461,
          '<U>': -320.6746666666668, '<U^2>': 102891.6684444445, 'cv': 0.030112754686201164,
          'flip_ratio': 0.02549216360856269},
         {'h': 0.1, 'J': 0.65, 'K': 3200, '<M>': 252.8294117647059, '<M^2>': 63929.211764705884,
          'std': 46.88601903113886, '<U>': -349.885294117647, '<U^2>': 122466.60505882348, 'cv': 0.02674740874134368,
          'flip_ratio': 0.014150776836158192},
         {'h': 0.1, 'J': 0.7000000000000001, 'K': 3200, '<M>': 254.0072463768116, '<M^2>': 64523.95652173913,
          'std': 35.391121088003274, '<U>': -378.2514492753624, '<U^2>': 143109.55000000005, 'cv': 0.023238452000235246,
          'flip_ratio': 0.010167365345528456},
         {'h': 0.1, 'J': 0.7500000000000001, 'K': 3200, '<M>': 254.73846153846154, '<M^2>': 64894.414201183434,
          'std': 26.095951038092608, '<U>': -405.6963313609469, '<U^2>': 164615.6092307693, 'cv': 0.019954764149836074,
          'flip_ratio': 0.006610576923076923},
         {'h': 0.1, 'J': 0.8000000000000002, 'K': 12800, '<M>': 255.20516177295679, '<M^2>': 65131.289321114644,
          'std': 17.417508524726145, '<U>': -432.5830185150551, '<U^2>': 187145.4854161212, 'cv': 0.01630245651958906,
          'flip_ratio': 0.004288466898207701}]

data = [{'h': 0, 'J': 0.15000000000000002, 'K': 104857600, '<M>': 0.06901451780665387, '<M^2>': 338.4266858088806,
         'std': 14.51906002715732, '<U>': 0.016127071094768606, '<U^2>': 14.519320109579414, 'cv': 0.014884329825026354,
         'flip_ratio': 0.5000545012557822},
        {'h': 0, 'J': 0.2, 'K': 104857600, '<M>': -0.001054902549714114, '<M^2>': 429.32529458519986,
         'std': 31.37529882586323, '<U>': 0.0179099010662574, '<U^2>': 31.375619590419433, 'cv': 0.02188033515640816,
         'flip_ratio': 0.50007449782713},
        {'h': 0, 'J': 0.25, 'K': 104857600, '<M>': 0.02127309009025502, '<M^2>': 601.6469106420373,
         'std': 64.8027818986139, '<U>': -0.029222122549109348, '<U^2>': 64.80363583106018, 'cv': 0.03144538089535795,
         'flip_ratio': 0.4999371440762758},
        {'h': 0, 'J': 0.3, 'K': 104857600, '<M>': -0.4383519490653059, '<M^2>': 968.1395868516395,
         'std': 139.1054957773887, '<U>': 0.04905907823736066, '<U^2>': 139.1079025705462, 'cv': 0.046071481607407185,
         'flip_ratio': 0.500067169148842},
        {'h': 0, 'J': 0.35, 'K': 400, '<M>': 0.0, '<M^2>': 0.0, 'std': 0.0, '<U>': 5.600000000000001,
         '<U^2>': 31.360000000000017, 'cv': 0.0, 'flip_ratio': 0.4735243055555556},
        {'h': 0, 'J': 0.39999999999999997, 'K': 104857600, '<M>': 1.2333111953414815, '<M^2>': 6541.016742926545,
         'std': 2045.668531319439, '<U>': 0.39489089394678806, '<U^2>': 2045.824470137561, 'cv': 0.17667604424821576,
         'flip_ratio': 0.5008569739749461},
        {'h': 0, 'J': 0.44999999999999996, 'K': 104857600, '<M>': -0.9071574884085514, '<M^2>': 20017.35760820534,
         'std': 20477.481199743987, '<U>': 2.212853012297659, '<U^2>': 20482.37791819802, 'cv': 0.5589826170447547,
         'flip_ratio': 0.5109882904846336},
        {'h': 0, 'J': 0.49999999999999994, 'K': 409600, '<M>': 233.06313253012047, '<M^2>': 54425.747148594375,
         'std': 365.54931952711195, '<U>': -212.19116465863453, '<U^2>': 45390.63967871486, 'cv': 0.0746849379634516,
         'flip_ratio': 0.0852061117102005},
        {'h': 0, 'J': 0.5499999999999999, 'K': 25600, '<M>': -244.3905013192612, '<M^2>': 59759.01846965699,
         'std': 144.4104981864657, '<U>': -256.630870712401, '<U^2>': 66003.81430079155, 'cv': 0.04694176530806888,
         'flip_ratio': 0.0505532126611069},
        {'h': 0, 'J': 0.6, 'K': 12800, '<M>': -249.0741935483871, '<M^2>': 62056.458064516126,
         'std': 101.79608740897675, '<U>': -290.8064516129031, '<U^2>': 84670.18838709674, 'cv': 0.03941173714975513,
         'flip_ratio': 0.03168815351711027},
        {'h': 0, 'J': 0.65, 'K': 51200, '<M>': 251.9361352430148, '<M^2>': 63481.204038506694, 'std': 61.78005990930251,
         '<U>': -322.3133129842687, '<U^2>': 103947.65178680445, 'cv': 0.03070323928227541,
         'flip_ratio': 0.01995449528584256},
        {'h': 0, 'J': 0.7000000000000001, 'K': 100, '<M>': 34.0, '<M^2>': 1156.0, 'std': 0.0, '<U>': 145.60000000000002,
         '<U^2>': 21199.360000000008, 'cv': 0.0, 'flip_ratio': 0.703125},
        {'h': 0, 'J': 0.7500000000000001, 'K': 12800, '<M>': -254.43851851851852, '<M^2>': 64742.21333333333,
         'std': 28.94147654317203, '<U>': -379.33111111111117, '<U^2>': 143921.03333333335, 'cv': 0.021014563657843426,
         'flip_ratio': 0.008225324348219426},
        {'h': 0, 'J': 0.8000000000000002, 'K': 102400, '<M>': 254.976694026721, '<M^2>': 65019.20472813239,
         'std': 21.374426871043397, '<U>': -406.35669030732873, '<U^2>': 165147.13418439732, 'cv': 0.018059564528445392,
         'flip_ratio': 0.004693123471075835}]

data0 = [{'h': 0, 'J': 0.15000000000000002, 'K': 104857600, '<M>': 0.00098869228966487, '<M^2>': 340.4549302788845,
          'std': 14.62456633573749, '<U>': -0.005850861260838994, '<U^2>': 14.624600568314985,
          'cv': 0.014938312248964303, 'flip_ratio': 0.4999678728104305},
         {'h': 0, 'J': 0.2, 'K': 104857600, '<M>': -0.0620859623617128, '<M^2>': 431.19234783372946,
          'std': 31.505355364048103, '<U>': -0.0007997861377726859, '<U^2>': 31.50535600370597,
          'cv': 0.02192563731888113, 'flip_ratio': 0.4999917460948872},
         {'h': 0, 'J': 0.25, 'K': 104857600, '<M>': -0.08129193893398189, '<M^2>': 602.7483077914848,
          'std': 65.26485766043653, '<U>': 0.024852023324640315, '<U^2>': 65.26547528349987, 'cv': 0.03155729228299995,
          'flip_ratio': 0.4999955130088982},
         {'h': 0, 'J': 0.3, 'K': 104857600, '<M>': -0.026957355967454907, '<M^2>': 973.5454525481696,
          'std': 139.982996334093, '<U>': -0.01723337410013988, '<U^2>': 139.9832933232759, 'cv': 0.046216566438871634,
          'flip_ratio': 0.5000818791808291},
         {'h': 0, 'J': 0.35, 'K': 104857600, '<M>': 0.18661534231509486, '<M^2>': 1997.9425093941893,
          'std': 354.23246134167937, '<U>': 0.17330693795252494, '<U^2>': 354.2624966364219, 'cv': 0.07351978241740703,
          'flip_ratio': 0.5003176820238481},
         {'h': 0, 'J': 0.39999999999999997, 'K': 104857600, '<M>': -1.1116676919471542, '<M^2>': 6696.817617248147,
          'std': 2052.969889651889, '<U>': -0.003737879719952049, '<U^2>': 2052.969903623634, 'cv': 0.17699105767767498,
          'flip_ratio': 0.5000102974932692},
         {'h': 0, 'J': 0.44999999999999996, 'K': 104857600, '<M>': 4.283357245337159, '<M^2>': 20605.58455429474,
          'std': 20343.219389974318, '<U>': -2.4705556280161716, '<U^2>': 20349.32303508544, 'cv': 0.5571471022304415,
          'flip_ratio': 0.5013858758519639},
         {'h': 0, 'J': 0.425, 'K': 104857600, '<M>': -1.3295347679371576, '<M^2>': 12955.472537847356,
          'std': 7840.750920610107, '<U>': 1.5167682690711952, '<U^2>': 7843.051506592168, 'cv': 0.34589068271520745,
          'flip_ratio': 0.4986044155085618},
         {'h': 0, 'J': 0.43, 'K': 800, '<M>': 6.707273520892028, '<M^2>': 11216.0, 'std': 166.40999999999985,
          '<U>': -57.620000000000005, '<U^2>': 3486.4744000000005, 'cv': 0.05039062499999998, 'flip_ratio': 0.42109375},
         {'h': 0, 'J': 0.435, 'K': 104857600, '<M>': 3.43016030242661, '<M^2>': 15845.685011852956,
          'std': 12360.207973952029, '<U>': 2.903053277092074, '<U^2>': 12368.635692281663, 'cv': 0.43428309458596764,
          'flip_ratio': 0.49744943865063923},
         {'h': 0, 'J': 0.44, 'K': 104857600, '<M>': -10.729198686726559, '<M^2>': 18249.83849622975,
          'std': 15010.856120556347, '<U>': -3.329153948840062, '<U^2>': 15021.939386571425, 'cv': 0.4785890587875013,
          'flip_ratio': 0.4942885340018765},
         {'h': 0, 'J': 0.445, 'K': 104857600, '<M>': -10.43593037681968, '<M^2>': 19058.817492420294,
          'std': 17767.624447092316, '<U>': 0.5455553190083613, '<U^2>': 17767.922077698415, 'cv': 0.520684581661393,
          'flip_ratio': 0.5007843294632962},
         {'h': 0, 'J': 0.45, 'K': 104857600, '<M>': -26.231299689699217, '<M^2>': 21447.620010685387,
          'std': 20464.55022553919, '<U>': -7.797817633717702, '<U^2>': 20525.35618538791, 'cv': 0.5588060979896687,
          'flip_ratio': 0.4831876634559408},
         {'h': 0, 'J': 0.455, 'K': 104857600, '<M>': -2.639405723866521, '<M^2>': 19560.92171793618,
          'std': 23253.382373255205, '<U>': 13.924026344999962, '<U^2>': 23447.260882911458, 'cv': 0.5956663970908186,
          'flip_ratio': 0.5095668670380185},
         {'h': 0, 'J': 0.46, 'K': 104857600, '<M>': 3.5868129392048895, '<M^2>': 23668.06782238871,
          'std': 25885.020540159323, '<U>': -9.110278978721007, '<U^2>': 25968.017723229448, 'cv': 0.6284696240080112,
          'flip_ratio': 0.5588035641991907},
         {'h': 0, 'J': 0.465, 'K': 100, '<M>': 48.0, '<M^2>': 2304.0, 'std': 0.0, '<U>': -16.739999999999995,
          '<U^2>': 280.2275999999998, 'cv': 0.0, 'flip_ratio': 0.4713541666666667},
         {'h': 0, 'J': 0.55, 'K': 25600, '<M>': -244.3905013192612, '<M^2>': 59759.01846965699,
         'std': 144.4104981864657, '<U>': -256.630870712401, '<U^2>': 66003.81430079155, 'cv': 0.04694176530806888,
         'flip_ratio': 0.0505532126611069},
         {'h': 0, 'J': 0.6000000000000001, 'K': 25600, '<M>': -249.2120743034056, '<M^2>': 62123.01238390093,
          'std': 90.46324607729912, '<U>': -291.1021671826625, '<U^2>': 84830.9349845201, 'cv': 0.037153190842813724,
          'flip_ratio': 0.029558330562943262},
         {'h': 0, 'J': 0.6500000000000001, 'K': 3200, '<M>': -251.86516853932585, '<M^2>': 63444.823970037454,
          'std': 58.08712704626669, '<U>': -322.1370786516855, '<U^2>': 103830.38456928848, 'cv': 0.029771449726972016,
          'flip_ratio': 0.020547901272577995},
         {'h': 0, 'J': 0.7000000000000002, 'K': 12800, '<M>': 253.51068883610452, '<M^2>': 64272.64133016627,
          'std': 38.25911628798349, '<U>': -351.4714964370546, '<U^2>': 123570.47192399048, 'cv': 0.024161700791873034,
          'flip_ratio': 0.0126320339143615},
         {'h': 0, 'J': 0.7500000000000002, 'K': 102400, '<M>': -254.40958240119315, '<M^2>': 64727.58650260999,
          'std': 29.839372362330323, '<U>': -379.24342841163315, '<U^2>': 143855.41736577183, 'cv': 0.02133805728350617,
          'flip_ratio': 0.008336101125351672},
         {'h': 0, 'J': 0.8000000000000003, 'K': 102400, '<M>': 254.976694026721, '<M^2>': 65019.20472813239,
          'std': 21.374426871043397, '<U>': -406.35669030732873, '<U^2>': 165147.13418439732,
          'cv': 0.018059564528445392, 'flip_ratio': 0.004693123471075835}]

J_values = [d['J'] for d in data]
J_values0 = [d['J'] for d in data0]


# U_values = [d['<U>'] for d in data]
# U_squared_values = [d['<U^2>'] for d in data]
# cv_values = [d['cv'] for d in data]
# flip_ratio_values = [d['flip_ratio'] for d in data]


def cv_vs_eta_for_different_values_of_h():
    cv_vector_eta_1 = np.array([d['cv'] for d in data3])
    cv_vector_eta_0_5 = np.array([d['cv'] for d in data2])
    cv_vector_eta_0_1 = np.array([d['cv'] for d in data1])
    cv_vector_eta_0 = np.array([d['cv'] for d in data])
    # Assuming you have a list of J values and a corresponding list of energy values

    # Plot the vectors
    plt.plot(J_values, cv_vector_eta_0, label=r'h = 0')
    plt.plot(J_values, cv_vector_eta_0_1, label=r'h = 0.1')
    plt.plot(J_values, cv_vector_eta_0_5, label=r'h = 0.5')
    plt.plot(J_values, cv_vector_eta_1, label=r'h = 1')

    # Add a legend
    plt.legend()

    # Add title and axis labels
    plt.title(r'$cv$ vs $\eta$ for different values of h')
    plt.xlabel('$\eta$')
    plt.ylabel(r'$cv$')


def M_N_vs_eta_for_different_values_of_h():
    M_vector_eta_1 = abs(np.array([d['<M>'] for d in data3])) / 16 ** 2
    M_vector_eta_0_5 = abs(np.array([d['<M>'] for d in data2])) / 16 ** 2
    M_vector_eta_0_1 = abs(np.array([d['<M>'] for d in data1])) / 16 ** 2
    M_vector_eta_0 = abs(np.array([d['<M>'] for d in data])) / 16 ** 2
    # Assuming you have a list of J values and a corresponding list of energy values

    # Plot the vectors
    plt.plot(J_values, M_vector_eta_0, label=r'h = 0')
    plt.plot(J_values, M_vector_eta_0_1, label=r'h = 0.1')
    plt.plot(J_values, M_vector_eta_0_5, label=r'h = 0.5')
    plt.plot(J_values, M_vector_eta_1, label=r'h = 1')

    # Add a legend
    plt.legend()

    # Add title and axis labels
    plt.title(r'$<M>/N$ vs $\eta$ for different values of h')
    plt.xlabel('$\eta$')
    plt.ylabel(r'$<M>/N$')


def U_N_vs_eta_for_different_values_of_h():
    U_vector_eta_1 = np.array([d['<U>'] for d in data3]) / 16 ** 2
    U_vector_eta_0_5 = np.array([d['<U>'] for d in data2]) / 16 ** 2
    U_vector_eta_0_1 = np.array([d['<U>'] for d in data1]) / 16 ** 2
    U_vector_eta_0 = np.array([d['<U>'] for d in data]) / 16 ** 2
    # Assuming you have a list of J values and a corresponding list of energy values

    # Plot the vectors
    plt.plot(J_values, U_vector_eta_0, label=r'h = 0')
    plt.plot(J_values, U_vector_eta_0_1, label=r'h = 0.1')
    plt.plot(J_values, U_vector_eta_0_5, label=r'h = 0.5')
    plt.plot(J_values, U_vector_eta_1, label=r'h = 1')

    # Add a legend
    plt.legend()

    # Add title and axis labels
    plt.title(r'$<U>/N$ vs $\eta$ for different values of h')
    plt.xlabel('$\eta$')
    plt.ylabel(r'$<U>/N$')


def M_vector_eta_0():
    M_vector_eta_0 = abs(np.array([d['<M>'] for d in data0]))
    plt.plot(J_values0, np.array(M_vector_eta_0) / 16 ** 2, **{'color': 'lightsteelblue', 'marker': 'o'})
    plt.xlabel('η')
    plt.ylabel('<M>/N')
    plt.title("M_values vs η  for h=0")
    plt.show()


def U_vector_eta_0():
    M_vector_eta_0 = (np.array([d['<U>'] for d in data0]))
    plt.plot(J_values0, np.array(M_vector_eta_0) / 16 ** 2, **{'color': 'lightsteelblue', 'marker': 'o'})
    plt.xlabel('η')
    plt.ylabel('<U>/N')
    plt.title("U_values vs η  for h=0")
    plt.show()


def flip_ratio_h_0():
    flip_ratio_values = [d['flip_ratio'] for d in data0]
    plt.plot(J_values0, flip_ratio_values, **{'color': 'lightsteelblue', 'marker': 'o'})
    plt.xlabel('η')
    plt.ylabel('flip_ratio')
    plt.title("flip_ratio_values vs η for h=0")
    plt.show()


def cv_h_0():
    cv_values = [d['cv'] for d in data0]
    plt.plot(J_values0, cv_values, **{'color': 'lightsteelblue', 'marker': 'o'})
    plt.xlabel('η')
    plt.ylabel('flip_ratio')
    plt.title("flip_ratio_values vs η for h=0")
    plt.show()


#
# plt.plot(J_values, np.array(U_values) / 16 ** 2)
# plt.xlabel('η')
# plt.ylabel('<U>/M')
# plt.title("Energy vs η for h=0 ")
# plt.show()
#
# plt.plot(J_values, cv_values)
# plt.xlabel('η')
# plt.ylabel('cv')
# plt.title("Heat Capacity vs η for h=0 ")


if __name__ == '__main__':
    # U_N_vs_eta_for_different_values_of_h()
    # M_N_vs_eta_for_different_values_of_h()
    # M_vector_eta_0()
    # flip_ratio_h_0()
    U_vector_eta_0()
    # cv_h_0()
    plt.show()
